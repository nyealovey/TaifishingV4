---
inclusion: always
---

## PYTHON

### Guidelines for CODE_QUALITY

#### FORMATTING

- 使用Black进行代码格式化，行长度限制为88字符
- 使用isort进行导入排序，按标准库、第三方库、本地模块分组
- 使用4个空格缩进，不使用制表符
- 函数和类之间使用两个空行分隔
- 方法之间使用一个空行分隔
- 使用有意义的变量和函数名，避免缩写

#### TYPE_HINTS

- 所有函数参数和返回值必须包含类型提示
- 使用typing模块的泛型和联合类型
- 复杂类型使用TypeAlias定义
- 使用Optional表示可能为None的值
- 使用Literal表示字面量类型
- 为类属性添加类型注解

#### DOCUMENTATION

- 所有公共函数、类和方法必须有docstring
- 使用Google风格的docstring格式
- 包含参数、返回值、异常和示例
- 复杂算法必须有详细注释
- 使用类型提示减少docstring中的类型信息

#### ERROR_HANDLING

- 避免裸露的except语句，必须指定异常类型
- 记录详细的错误信息用于调试
- 使用适当的异常类型，不要滥用Exception
- 实现优雅的错误恢复机制
- 避免使用try-except-pass模式

#### PERFORMANCE

- 使用生成器处理大数据集
- 避免在循环中进行重复计算
- 使用列表推导式和生成器表达式
- 合理使用缓存减少重复计算
- 避免不必要的对象创建

#### TESTING

- 编写单元测试覆盖核心功能
- 使用pytest作为测试框架
- 测试覆盖率目标80%以上
- 使用fixture管理测试数据
- 编写集成测试验证组件交互

#### LINTING

- 使用Ruff进行代码检查
- 修复所有警告和错误
- 使用mypy进行类型检查
- 配置pre-commit钩子自动检查
- 定期运行代码质量检查

#### IMPORT_ORGANIZATION

- 标准库导入在最前面
- 第三方库导入在中间
- 本地模块导入在最后
- 每组导入之间使用空行分隔
- 使用绝对导入路径

#### NAMING_CONVENTIONS

- 变量和函数使用snake_case
- 类名使用PascalCase
- 常量使用UPPER_SNAKE_CASE
- 私有方法使用单下划线前缀
- 避免使用内置函数名作为变量名

#### CODE_STRUCTURE

- 单个函数不超过50行
- 单个类不超过500行
- 使用组合而不是继承
- 遵循单一职责原则
- 避免深层嵌套，最多3层

#### MEMORY_MANAGEMENT

- 及时释放不需要的资源
- 使用上下文管理器管理资源
- 避免循环引用
- 使用弱引用处理循环依赖
- 监控内存使用情况

#### CONCURRENCY

- 使用asyncio处理异步操作
- 避免使用全局变量
- 使用线程安全的数据结构
- 合理使用锁和信号量
- 避免死锁和竞态条件

#### DATA_VALIDATION

- 使用Pydantic进行数据验证
- 验证输入数据的类型和格式
- 使用正则表达式验证复杂格式
- 实现数据清洗和转换
- 记录验证失败的原因

#### LOGGING

- 使用结构化日志记录
- 设置适当的日志级别
- 记录关键操作和错误
- 使用日志轮转避免文件过大
- 不在日志中记录敏感信息

#### CONFIGURATION

- 使用环境变量管理配置
- 提供默认配置值
- 验证配置参数的有效性
- 使用配置文件管理复杂配置
- 实现配置热重载

#### DEPENDENCY_MANAGEMENT

- 使用requirements.txt管理依赖
- 固定依赖版本避免兼容性问题
- 定期更新依赖包
- 使用虚拟环境隔离依赖
- 记录依赖变更原因
