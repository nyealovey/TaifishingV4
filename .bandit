# Bandit 安全扫描配置文件
[bandit]
# 排除的测试文件
exclude_dirs = ["tests", "test", "migrations", "userdata", "venv", ".venv", "__pycache__"]

# 排除的文件模式
exclude = ["*/test_*.py", "*/tests/*.py", "*/migrations/*.py"]

# 跳过检查的测试ID（根据实际情况调整）
skips = [
    "B101",  # 使用 assert 语句
    "B601",  # 参数化 shell 命令
    "B603",  # subprocess 调用 - 检查 shell 参数
    "B607",  # 启动进程时使用 shell=True
]

# 严重性级别过滤
severity = "medium"  # 只报告中等及以上严重性的问题

# 置信度级别过滤
confidence = "medium"  # 只报告中等及以上置信度的问题

# 输出格式
format = "json"  # 可选: txt, json, csv, xml

# 输出文件
output = "bandit-report.json"

# 详细输出
verbose = true

# 显示跳过的文件
show_skipped = true

# 聚合输出
aggregate = true

# 递归扫描
recursive = true

# 包含的测试ID（空表示包含所有）
tests = []

# 排除的测试ID
exclude_tests = []

# 配置文件路径
config_file = ".bandit"

# 基准测试
baseline = ""

# 报告格式
report_format = "json"

# 输出目录
output_dir = "reports"

# 创建输出目录
create_output_dir = true
