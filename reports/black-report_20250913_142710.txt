é”™è¯¯: error: cannot format /Users/shiyijiufei/TaifishingV4/app/services/account_classification_service.py: Cannot parse for target version Python 3.13: 26:4:     def create_classification(
would reformat /Users/shiyijiufei/TaifishingV4/app/utils/safe_query_builder.py

Oh no! ğŸ’¥ ğŸ’” ğŸ’¥
1 file would be reformatted, 65 files would be left unchanged, 1 file would fail to reformat.


æ ‡å‡†è¾“å‡º:
--- /Users/shiyijiufei/TaifishingV4/app/utils/safe_query_builder.py	2025-09-13 02:23:59.651728+00:00
+++ /Users/shiyijiufei/TaifishingV4/app/utils/safe_query_builder.py	2025-09-13 06:27:11.863948+00:00
@@ -6,107 +6,105 @@
 from typing import Any, Dict, List, Tuple
 
 
 class SafeQueryBuilder:
     """å®‰å…¨æŸ¥è¯¢æ„å»ºå™¨"""
-    
+
     def __init__(self):
         self.conditions: List[str] = []
         self.parameters: List[Any] = []
-    
+
     def add_condition(self, condition: str, *params: Any) -> "SafeQueryBuilder":
         """
         æ·»åŠ æŸ¥è¯¢æ¡ä»¶
-        
+
         Args:
             condition: SQLæ¡ä»¶å­—ç¬¦ä¸²ï¼Œä½¿ç”¨%sä½œä¸ºå‚æ•°å ä½ç¬¦
             *params: å‚æ•°å€¼
-            
+
         Returns:
             SafeQueryBuilder: è¿”å›è‡ªèº«ä»¥æ”¯æŒé“¾å¼è°ƒç”¨
         """
         self.conditions.append(condition)
         self.parameters.extend(params)
         return self
-    
+
     def add_in_condition(self, field: str, values: List[str]) -> "SafeQueryBuilder":
         """
         æ·»åŠ INæ¡ä»¶
-        
+
         Args:
             field: å­—æ®µå
             values: å€¼åˆ—è¡¨
-            
+
         Returns:
             SafeQueryBuilder: è¿”å›è‡ªèº«ä»¥æ”¯æŒé“¾å¼è°ƒç”¨
         """
         if values:
             placeholders = ", ".join(["%s"] * len(values))
             condition = f"{field} NOT IN ({placeholders})"
             self.add_condition(condition, *values)
         return self
-    
+
     def add_like_condition(self, field: str, pattern: str) -> "SafeQueryBuilder":
         """
         æ·»åŠ LIKEæ¡ä»¶
-        
+
         Args:
             field: å­—æ®µå
             pattern: æ¨¡å¼å­—ç¬¦ä¸²
-            
+
         Returns:
             SafeQueryBuilder: è¿”å›è‡ªèº«ä»¥æ”¯æŒé“¾å¼è°ƒç”¨
         """
         condition = f"{field} NOT LIKE %s"
         self.add_condition(condition, pattern)
         return self
-    
+
     def build_where_clause(self) -> Tuple[str, List[Any]]:
         """
         æ„å»ºWHEREå­å¥
-        
+
         Returns:
             Tuple[str, List[Any]]: WHEREå­å¥å’Œå‚æ•°åˆ—è¡¨
         """
         if not self.conditions:
             return "1=1", []
-        
+
         where_clause = " AND ".join(self.conditions)
         return where_clause, self.parameters.copy()
-    
+
     def reset(self) -> "SafeQueryBuilder":
         """é‡ç½®æ„å»ºå™¨"""
         self.conditions.clear()
         self.parameters.clear()
         return self
 
 
 def build_safe_filter_conditions(
-    db_type: str, 
-    username_field: str, 
-    filter_rules: Dict[str, Any]
+    db_type: str, username_field: str, filter_rules: Dict[str, Any]
 ) -> Tuple[str, List[Any]]:
     """
     æ„å»ºå®‰å…¨çš„è¿‡æ»¤æ¡ä»¶
-    
+
     Args:
         db_type: æ•°æ®åº“ç±»å‹
         username_field: ç”¨æˆ·åå­—æ®µå
         filter_rules: è¿‡æ»¤è§„åˆ™
-        
+
     Returns:
         Tuple[str, List[Any]]: WHEREå­å¥å’Œå‚æ•°åˆ—è¡¨
     """
     builder = SafeQueryBuilder()
     rules = filter_rules.get(db_type, {})
-    
+
     # æ’é™¤ç‰¹å®šç”¨æˆ·
     exclude_users = rules.get("exclude_users", [])
     if exclude_users:
         builder.add_in_condition(username_field, exclude_users)
-    
+
     # æ’é™¤æ¨¡å¼åŒ¹é…
     exclude_patterns = rules.get("exclude_patterns", [])
     for pattern in exclude_patterns:
         builder.add_like_condition(username_field, pattern)
-    
+
     return builder.build_where_clause()
