# æ³°æ‘¸é±¼å§ - é¡¹ç›®ç»“æ„

## é¡¹ç›®ç›®å½•ç»“æ„

```
TaifishV4/
â”œâ”€â”€ app/                           # Flaskåº”ç”¨ä¸»ç›®å½• âœ…
â”‚   â”œâ”€â”€ __init__.py               # åº”ç”¨åˆå§‹åŒ– âœ…
â”‚   â”œâ”€â”€ models/                   # æ•°æ®æ¨¡å‹ âœ…
â”‚   â”‚   â”œâ”€â”€ __init__.py           # æ¨¡å‹åˆå§‹åŒ– âœ…
â”‚   â”‚   â”œâ”€â”€ user.py              # ç”¨æˆ·æ¨¡å‹ âœ…
â”‚   â”‚   â”œâ”€â”€ instance.py          # å®ä¾‹æ¨¡å‹ âœ…
â”‚   â”‚   â”œâ”€â”€ credential.py        # å‡­æ®æ¨¡å‹ âœ…
â”‚   â”‚   â””â”€â”€ sync_data.py         # åŒæ­¥æ•°æ®æ¨¡å‹ âœ…
â”‚   â”œâ”€â”€ routes/                   # è·¯ç”±å®šä¹‰ âœ…
â”‚   â”‚   â”œâ”€â”€ __init__.py           # è·¯ç”±åˆå§‹åŒ– âœ…
â”‚   â”‚   â”œâ”€â”€ main.py              # ä¸»é¡µé¢è·¯ç”± âœ…
â”‚   â”‚   â”œâ”€â”€ auth.py              # è®¤è¯è·¯ç”± ğŸ”„
â”‚   â”‚   â”œâ”€â”€ instances.py         # å®ä¾‹ç®¡ç†è·¯ç”± ğŸ”„
â”‚   â”‚   â”œâ”€â”€ credentials.py       # å‡­æ®ç®¡ç†è·¯ç”± ğŸ”„
â”‚   â”‚   â”œâ”€â”€ accounts.py          # è´¦æˆ·ç®¡ç†è·¯ç”± ğŸ”„
â”‚   â”‚   â”œâ”€â”€ tasks.py             # ä»»åŠ¡ç®¡ç†è·¯ç”± ğŸ”„
â”‚   â”‚   â”œâ”€â”€ params.py            # å‚æ•°ç®¡ç†è·¯ç”± ğŸ”„
â”‚   â”‚   â”œâ”€â”€ logs.py              # æ—¥å¿—ç®¡ç†è·¯ç”± ğŸ”„
â”‚   â”‚   â””â”€â”€ api.py               # APIè·¯ç”± ğŸ”„
â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡é€»è¾‘æœåŠ¡ âœ…
â”‚   â”‚   â”œâ”€â”€ database_service.py  # æ•°æ®åº“æœåŠ¡ âœ…
â”‚   â”‚   â””â”€â”€ database_drivers.py  # æ•°æ®åº“é©±åŠ¨æ£€æŸ¥ âœ…
â”‚   â””â”€â”€ templates/                # Jinja2æ¨¡æ¿ âœ…
â”‚       â””â”€â”€ index.html           # é¦–é¡µæ¨¡æ¿ âœ…
â”œâ”€â”€ scripts/                      # è„šæœ¬ç›®å½• âœ…
â”‚   â”œâ”€â”€ start_redis.sh           # Redisç®¡ç†è„šæœ¬ âœ…
â”‚   â”œâ”€â”€ migrate_db.py            # æ•°æ®åº“è¿ç§»è„šæœ¬ âœ…
â”‚   â”œâ”€â”€ init_data.py             # æ•°æ®åˆå§‹åŒ–è„šæœ¬ âœ…
â”‚   â””â”€â”€ init_database.py         # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ âœ…
â”‚   â”‚   â””â”€â”€ (å¾…å®ç°)
â”‚   â”œâ”€â”€ validators/              # æ•°æ®éªŒè¯å™¨
â”‚   â”‚   â””â”€â”€ (å¾…å®ç°)
â”‚   â””â”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”‚       â””â”€â”€ (å¾…å®ç°)
â”œâ”€â”€ tests/                        # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ api/                     # APIæµ‹è¯•
â”‚   â”œâ”€â”€ cache/                   # ç¼“å­˜æµ‹è¯•
â”‚   â”œâ”€â”€ task/                    # ä»»åŠ¡æµ‹è¯•
â”‚   â””â”€â”€ security/                # å®‰å…¨æµ‹è¯•
â”œâ”€â”€ docker/                       # Dockeré…ç½®
â”‚   â”œâ”€â”€ postgres/                # PostgreSQLé…ç½®
â”‚   â”‚   â””â”€â”€ init.sql
â”‚   â”œâ”€â”€ redis/                   # Redisé…ç½®
â”‚   â”‚   â””â”€â”€ redis.conf
â”‚   â””â”€â”€ nginx/                   # Nginxé…ç½®
â”‚       â””â”€â”€ nginx.conf
â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ (å¾…å®ç°)
â”œâ”€â”€ userdata/                     # ç”¨æˆ·æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ logs/                    # æ—¥å¿—æ–‡ä»¶
â”‚   â”œâ”€â”€ uploads/                 # ä¸Šä¼ æ–‡ä»¶
â”‚   â”œâ”€â”€ backups/                 # å¤‡ä»½æ–‡ä»¶
â”‚   â””â”€â”€ exports/                 # å¯¼å‡ºæ–‡ä»¶
â”œâ”€â”€ .env                         # ç¯å¢ƒå˜é‡æ–‡ä»¶
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore                   # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ Dockerfile                   # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml           # Docker Composeå¼€å‘é…ç½®
â”œâ”€â”€ docker-compose.prod.yml      # Docker Composeç”Ÿäº§é…ç½®
â”œâ”€â”€ requirements.txt             # Pythonä¾èµ–
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ spec.md                      # æŠ€æœ¯è§„æ ¼æ–‡æ¡£
â”œâ”€â”€ todolist.md                  # ä»»åŠ¡æ¸…å•
â””â”€â”€ PROJECT_STRUCTURE.md         # é¡¹ç›®ç»“æ„æ–‡æ¡£
```

## æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### åº”ç”¨æ ¸å¿ƒæ–‡ä»¶
- `app/__init__.py`: Flaskåº”ç”¨åˆå§‹åŒ–ï¼Œé…ç½®æ‰©å±•å’Œè“å›¾
- `app/config.py`: åº”ç”¨é…ç½®ç®¡ç†ï¼Œæ”¯æŒå¼€å‘/ç”Ÿäº§/æµ‹è¯•ç¯å¢ƒ
- `app/models/`: æ•°æ®æ¨¡å‹å®šä¹‰ï¼ŒåŒ…å«æ‰€æœ‰æ•°æ®åº“è¡¨æ¨¡å‹
- `app/routes/`: è·¯ç”±å®šä¹‰ï¼ŒåŒ…å«æ‰€æœ‰é¡µé¢å’ŒAPIè·¯ç”±
- `app/templates/`: Jinja2æ¨¡æ¿æ–‡ä»¶ï¼Œç”¨äºé¡µé¢æ¸²æŸ“
- `app/utils/`: å·¥å…·å‡½æ•°ï¼ŒåŒ…å«æ—¥å¿—å’Œç¯å¢ƒå˜é‡ç®¡ç†

### Dockeré…ç½®æ–‡ä»¶
- `Dockerfile`: åº”ç”¨å®¹å™¨é•œåƒæ„å»ºæ–‡ä»¶
- `docker-compose.yml`: å¼€å‘ç¯å¢ƒDocker Composeé…ç½®
- `docker-compose.prod.yml`: ç”Ÿäº§ç¯å¢ƒDocker Composeé…ç½®
- `docker/`: å„ç§æœåŠ¡çš„é…ç½®æ–‡ä»¶

### è„šæœ¬æ–‡ä»¶
- `scripts/start_dev.sh`: å¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬
- `scripts/start_prod.sh`: ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è„šæœ¬
- `scripts/data_requirements.md`: æ•°æ®è¦æ±‚å’Œç”Ÿæˆè„šæœ¬è§„èŒƒ

### é…ç½®æ–‡ä»¶
- `.env`: ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
- `.env.example`: ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
- `requirements.txt`: Pythonä¾èµ–åŒ…åˆ—è¡¨
- `.gitignore`: Gitç‰ˆæœ¬æ§åˆ¶å¿½ç•¥æ–‡ä»¶

### æ–‡æ¡£æ–‡ä»¶
- `README.md`: é¡¹ç›®è¯´æ˜æ–‡æ¡£
- `spec.md`: è¯¦ç»†æŠ€æœ¯è§„æ ¼æ–‡æ¡£
- `todolist.md`: å¼€å‘ä»»åŠ¡æ¸…å•
- `PROJECT_STRUCTURE.md`: é¡¹ç›®ç»“æ„è¯´æ˜æ–‡æ¡£

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **Webæ¡†æ¶**: Flask 2.0.3 + Jinja2 3.0.3
- **æ•°æ®åº“**: PostgreSQL 13.5
- **ç¼“å­˜**: Redis 4.0.2
- **ä»»åŠ¡é˜Ÿåˆ—**: Celery 5.2.7
- **æ•°æ®åº“é©±åŠ¨**: pymssql, pymysql, cx_Oracle

### å‰ç«¯æŠ€æœ¯
- **æ¨¡æ¿å¼•æ“**: Jinja2 3.0.3
- **æ ·å¼æ¡†æ¶**: Bootstrap 5
- **å›¾æ ‡åº“**: Font Awesome 6
- **å›¾è¡¨åº“**: Chart.js

### éƒ¨ç½²æŠ€æœ¯
- **å®¹å™¨åŒ–**: Docker 20.10.12 + Docker Compose 1.29.2
- **WebæœåŠ¡å™¨**: Nginx (å¯é€‰)
- **è¿›ç¨‹ç®¡ç†**: Gunicorn

## å¼€å‘ç¯å¢ƒå¯åŠ¨

### ä½¿ç”¨å¯åŠ¨è„šæœ¬
```bash
# å¼€å‘ç¯å¢ƒ
./scripts/start_dev.sh

# ç”Ÿäº§ç¯å¢ƒ
./scripts/start_prod.sh
```

### æ‰‹åŠ¨å¯åŠ¨
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## æ•°æ®è¦æ±‚

æœ¬é¡¹ç›®ä¸¥æ ¼è¦æ±‚ä½¿ç”¨çœŸå®æ•°æ®ï¼Œç¦æ­¢ä½¿ç”¨ä»»ä½•å½¢å¼çš„æ¨¡æ‹Ÿæ•°æ®ã€å‡æ•°æ®æˆ–ç¡¬ç¼–ç æµ‹è¯•æ•°æ®ã€‚æ‰€æœ‰æ•°æ®å¿…é¡»é€šè¿‡çœŸå®æ•°æ®åº“è¿æ¥è·å–æˆ–é€šè¿‡è„šæœ¬è‡ªåŠ¨ç”Ÿæˆã€‚

## ä¸‹ä¸€æ­¥å¼€å‘

1. å®ç°æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“è¿ç§»
2. å®ç°ç”¨æˆ·è®¤è¯å’Œæƒé™ç³»ç»Ÿ
3. å®ç°æ•°æ®åº“å®ä¾‹ç®¡ç†åŠŸèƒ½
4. å®ç°å‡­æ®ç®¡ç†åŠŸèƒ½
5. å®ç°è´¦æˆ·ç»Ÿè®¡å’Œæœç´¢åŠŸèƒ½
6. å®ç°å®šæ—¶ä»»åŠ¡ç³»ç»Ÿ
7. å®ç°å…¨å±€å‚æ•°ç®¡ç†
8. å®ç°æ—¥å¿—ç®¡ç†ç³»ç»Ÿ
9. å®Œå–„å‰ç«¯ç•Œé¢
10. å®ç°æµ‹è¯•å¥—ä»¶
